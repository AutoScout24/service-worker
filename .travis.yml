language: node_js
node_js:
  - "7"

cache:
  yarn: true
  directories:
    - node_modules

env:
  global:
    - secure: "j1XBcUvi858C5CM6AdTa+OyEnMvveiHuX6t7DbDG37EXLdSpI8mFpaiK5114ziSxvFwbp73azTwoTfz6snhr1wSZwj2T+/mORwbquueGGHbbBh7RjIuifD/v6NI9/f3PbQcypV+mnHZUjXOJz1qjSZcE7gWK36uKyLTrrHQ/G7yMkPpdFnsElLj1Ld0P6fHqi33LUg0uK2hFHOKsMbKjZXPx3RP7fD3q8xQf5Pfvu8ig2Kn4ggzLIG3kgvJZhUAC85BNd/bpXpyp88cx6ZjCgc3Va2/k/2l1tTjsfCwEQqfIWKImmTXe61+MVUpRjIMzwLH1W2lsGgJeJZUaFvli+f7Iabu5uMsL7kLRSDVl/tgz7JT6vR87wK6g6iUNCnaxBeyhSsOW36Of0WqFze9DgY8ETTJByr53cAJ7pQY2+TiJHR3hkFP1htX236rv/rBmMCW6zWbs45tpS0Qq7w//1KRKeR6co/x6VMH5RciGfc03tkibhiZKOsRg/2fRc2IKA5vxHuWFFN3ubWR5drX05RwCx4AGmNc43sVh8lW3TIwO64MPWgQmCvhSOkJsx56UW5/sCN35pPbjrE5vBHnsUlXVlYV6T9x0q5GqJ85PDklO5rYn+HyXgvYavEi7W/NZIzWi7+f9Dg1jfERYbJJVU4N9XSJznfVD0piFz8okKqI="

branches:
  except:
    - release
    - meta

notifications:
  email: false

script:
  - npm run build

after_success:
  # only run for master branch, we don't want to release PRs and other branches
  - 'if [ "$TRAVIS_PULL_REQUEST" != "true" ] && [ "$TRAVIS_BRANCH" == "master" ]; then openssl aes-256-cbc -K $encrypted_3ecb91fa7524_key -iv $encrypted_3ecb91fa7524_iv -in release_key.enc -out release_key -d; fi'
  - 'if [ "$TRAVIS_PULL_REQUEST" != "true" ] && [ "$TRAVIS_BRANCH" == "master" ]; then bash ./travis_release.sh; fi'
